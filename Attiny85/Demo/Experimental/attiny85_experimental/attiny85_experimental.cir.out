* /home/ash98/esim-workspace/attiny85_experimental/attiny85_experimental.cir

.include lm_741.sub
.include LED.lib
* u5  net-_u1-pad6_ net-_u1-pad7_ net-_u1-pad8_ net-_u1-pad9_ pb0 gnd gnd gnd dac_bridge_4
* u4  ref2 plot_v1
* u6  ref3 plot_v1
* u3  ref1 plot_v1
x1 ? net-_r5-pad1_ net-_r6-pad1_ net-_x1-pad4_ ? out1 net-_x1-pad7_ ? lm_741
r5  net-_r5-pad1_ ref1 1k
x2 ? net-_r9-pad1_ net-_r10-pad1_ net-_x1-pad4_ ? out2 net-_x1-pad7_ ? lm_741
r9  net-_r9-pad1_ ref2 1k
r7  net-_r7-pad1_ ref3 1k
r6  net-_r6-pad1_ v_in 1k
r10  net-_r10-pad1_ v_in 1k
r8  net-_r8-pad1_ v_in 1k
r11  net-_r11-pad1_ out1 1k
r12  net-_r12-pad1_ out2 1k
r13  net-_r13-pad1_ out3 1k
v3  net-_x1-pad7_ gnd 12
* u8  out1 plot_v1
* u9  out2 plot_v1
* u10  out3 plot_v1
v4  gnd net-_x1-pad4_ 12
* u11  net-_r11-pad1_ net-_r12-pad1_ net-_r13-pad1_ net-_u11-pad4_ net-_u11-pad5_ net-_u11-pad6_ adc_bridge_3
* u14  net-_u1-pad4_ net-_u1-pad5_ bin1 bin2 dac_bridge_2
* u2  v_in plot_v1
v1  net-_r1-pad2_ gnd 4
r1  ref1 net-_r1-pad2_ 1k
r2  ref2 ref1 1k
r3  ref3 ref2 1k
r4  gnd ref3 1k
* u7  net-_u11-pad4_ net-_u11-pad5_ net-_u11-pad6_ net-_u1-pad4_ net-_u1-pad5_ therm2bin2bit
v2  v_in gnd pwl(50u 0 550u 1 1050u 2 1550u 3 2050u 4)
x3 ? net-_r7-pad1_ net-_r8-pad1_ net-_x1-pad4_ ? out3 net-_x1-pad7_ ? lm_741
r14  gnd bin1 1k
* u15  bin1 plot_v1
r15  gnd bin2 1k
* u13  bin2 plot_v1
r16  gnd net-_d1-pad2_ 1k
* u12  net-_u12-pad1_ gnd net-_u12-pad3_ net-_u1-pad1_ net-_u1-pad2_ net-_u1-pad3_ adc_bridge_3
v6 net-_u12-pad1_ gnd  dc 5
v5  net-_u12-pad3_ gnd pulse(0 5 0 0 0 0.5e-6 1e-6)
* u16  pb0 plot_v1
* u1  net-_u1-pad1_ net-_u1-pad2_ net-_u1-pad3_ net-_u1-pad4_ net-_u1-pad5_ net-_u1-pad6_ net-_u1-pad7_ net-_u1-pad8_ net-_u1-pad9_ attiny85_exp
d1 pb0 net-_d1-pad2_ LED
a1 [net-_u1-pad6_ net-_u1-pad7_ net-_u1-pad8_ net-_u1-pad9_ ] [pb0 gnd gnd gnd ] u5
a2 [net-_r11-pad1_ net-_r12-pad1_ net-_r13-pad1_ ] [net-_u11-pad4_ net-_u11-pad5_ net-_u11-pad6_ ] u11
a3 [net-_u1-pad4_ net-_u1-pad5_ ] [bin1 bin2 ] u14
a4 [net-_u11-pad4_ net-_u11-pad5_ net-_u11-pad6_ ] [net-_u1-pad4_ net-_u1-pad5_ ] u7
a5 [net-_u12-pad1_ gnd net-_u12-pad3_ ] [net-_u1-pad1_ net-_u1-pad2_ net-_u1-pad3_ ] u12
a6 [net-_u1-pad1_ ] [net-_u1-pad2_ ] [net-_u1-pad3_ ] [net-_u1-pad4_ ] [net-_u1-pad5_ ] [net-_u1-pad6_ ] [net-_u1-pad7_ ] [net-_u1-pad8_ ] [net-_u1-pad9_ ] u1
* Schematic Name: dac_bridge_4, NgSpice Name: dac_bridge
.model u5 dac_bridge(out_undef=0.5 out_low=0.0 out_high=5.0 t_rise=1.0e-9 t_fall=1.0e-9 input_load=1.0e-12 ) 
* Schematic Name: adc_bridge_3, NgSpice Name: adc_bridge
.model u11 adc_bridge(fall_delay=1.0e-9 in_high=2.0 rise_delay=1.0e-9 in_low=1.0 ) 
* Schematic Name: dac_bridge_2, NgSpice Name: dac_bridge
.model u14 dac_bridge(out_undef=0.5 out_low=0.0 out_high=5.0 t_rise=1.0e-9 t_fall=1.0e-9 input_load=1.0e-12 ) 
* Schematic Name: therm2bin2bit, NgSpice Name: therm2bin2bit
.model u7 therm2bin2bit(fall_delay=1.0e-9 input_load=1.0e-12 rise_delay=1.0e-9 instance_id=1 ) 
* Schematic Name: adc_bridge_3, NgSpice Name: adc_bridge
.model u12 adc_bridge(fall_delay=1.0e-9 in_high=2.0 rise_delay=1.0e-9 in_low=1.0 ) 
* Schematic Name: attiny85_exp, NgSpice Name: attiny85_exp
.model u1 attiny85_exp(fall_delay=1.0e-9 input_load=1.0e-12 rise_delay=1.0e-9 instance_id=1 ) 
.tran 0.5e-06 2.1e-3 0e-00

* Control Statements 
.control

*******Style Parameters******
set hcopydevtype=postscript
set color0 = rgb:f/f/e
set xfont 20
*background
set color1 = rgb:/f/f/f
set xbrushwidth 10
*grid and text
set color2 = rgb:f/0/0  
*vector0
set color3 = rgb:0/0/f  
*vector1
set color4 = rgb:0/f/0
*vector2 

run
print allv > plot_data_v.txt
print alli > plot_data_i.txt
*plot v(ref2)
*plot v(ref3)
*plot v(ref1)
*plot v(out1)
*plot v(out2)
*plot v(out3)
*plot v(v_in)
plot v(bin1)
plot v(bin2)
plot v(pb0) v(v_in)
.endc
.end
